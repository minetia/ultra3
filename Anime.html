<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì£¼êµ°ì˜ AI AUTO ì‹œìŠ¤í…œ v8.5</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #000000; --card: #161616; --up: #ff3b30; --down: #0a84ff; --gold: #ffcc00; --text: #ffffff; --input-bg: #222; }
        body { background: var(--bg); color: var(--text); font-family: 'Pretendard', sans-serif; margin: 0; padding: 12px; padding-bottom: 80px; }
        
        .summary-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .stat-card { background: var(--card); padding: 12px; border-radius: 12px; text-align: center; border: 1px solid #333; }
        .stat-card small { color: #888; font-size: 10px; display: block; margin-bottom: 4px; }
        .stat-card .val { font-size: 15px; font-weight: 700; }
        .up { color: var(--up); } .down { color: var(--down); }

        .narrative-box { position: relative; width: 100%; height: 45vh; border-radius: 16px; overflow: hidden; margin-bottom: 15px; border: 1px solid #333; background: #000; }
        #main-img { width: 100%; height: 100%; object-fit: cover; transition: opacity 0.5s ease-in-out; filter: brightness(0.65); }
        
        .price-overlay { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 100%; z-index: 10; }
        .price-overlay .label { font-size: 11px; color: rgba(255,255,255,0.7); letter-spacing: 2px; margin-bottom: 5px; }
        .price-overlay .big-price { font-size: 32px; font-weight: 800; color: #fff; text-shadow: 0 4px 20px rgba(0,0,0,0.9); letter-spacing: 1px; }

        .ai-watermark { position: absolute; top: 15px; right: 15px; font-size: 10px; font-weight: 900; color: #555; border: 1px solid #555; padding: 3px 8px; border-radius: 12px; letter-spacing: 1px; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); transition: 0.3s; }
        .ai-active { color: var(--up) !important; border-color: var(--up) !important; animation: blink 2s infinite; }

        .text-overlay { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(to top, rgba(0,0,0,0.95), transparent); padding: 20px; text-align: center; }
        #scene-title { color: var(--gold); font-size: 14px; font-weight: bold; margin-bottom: 5px; }
        #scene-desc { font-size: 12px; color: #ccc; line-height: 1.4; }

        .control-panel { background: var(--card); padding: 15px; border-radius: 16px; border: 1px solid #222; display: flex; flex-direction: column; gap: 12px; }
        .input-row { display: grid; grid-template-columns: 1fr 2fr; gap: 10px; }
        select, input { width: 100%; padding: 12px; background: var(--input-bg); border: 1px solid #444; border-radius: 8px; color: #fff; font-weight: bold; font-size: 14px; outline: none; box-sizing: border-box; }
        
        .action-row { display: grid; grid-template-columns: 70px 1fr; gap: 10px; align-items: center; }
        .chart-container { position: relative; height: 70px; width: 70px; }
        
        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; width: 100%; }
        .btn { border: none; padding: 14px; border-radius: 8px; font-weight: 700; color: white; font-size: 13px; cursor: pointer; transition: 0.2s; }
        .btn-buy { background: var(--up); }
        .btn-sell { background: var(--down); }
        .btn-auto { grid-column: span 2; background: #333; color: #aaa; border: 1px solid #555; margin-top: 5px; }
        .btn-auto.on { background: linear-gradient(135deg, var(--gold), #b38f00); color: #000; border: none; box-shadow: 0 0 15px rgba(255, 204, 0, 0.4); }

        /* [í•µì‹¬] ë¦¬ì–¼íƒ€ì„ ë¡œê·¸ ìŠ¤íƒ€ì¼ */
        .log-box { margin-top: 15px; padding: 10px; background: #000; border-radius: 12px; height: 160px; overflow-y: scroll; font-size: 11px; color: #aaa; border: 1px solid #333; font-family: 'Courier New', monospace; line-height: 1.6; }
        .log-line { display: block; border-bottom: 1px dashed #222; padding: 2px 0; }
        .log-time { color: #666; margin-right: 5px; }
        .log-info { color: #888; } /* ì¼ë°˜ ì •ë³´ */
        .log-buy { color: var(--up); font-weight: bold; } /* ë§¤ìˆ˜ */
        .log-sell { color: var(--down); font-weight: bold; } /* ë§¤ë„ */
        .log-sys { color: var(--gold); } /* ì‹œìŠ¤í…œ ì•Œë¦¼ */

        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        .reunion-glow { animation: glow 2s infinite alternate; border: 2px solid var(--gold); }
        @keyframes glow { from { box-shadow: 0 0 5px var(--gold); } to { box-shadow: 0 0 20px var(--gold); } }
    </style>
</head>
<body>

    <div class="summary-grid">
        <div class="stat-card"><small>ì´ ìì‚° (USDT)</small><div id="total-val" class="val">10,000</div></div>
        <div class="stat-card"><small>ë³´ìœ  í‰ê°€ê¸ˆ</small><div id="coin-val" class="val" style="color:var(--gold)">0.00</div></div>
        <div class="stat-card"><small>ì†ìµ (P&L)</small><div id="pnl-val" class="val">0.00</div></div>
        <div class="stat-card"><small>ìˆ˜ìµë¥  (ROI)</small><div id="roi-val" class="val">0.00%</div></div>
    </div>

    <div class="narrative-box" id="narrative-container">
        <img id="main-img" src="1771031113457.jpg" alt="ë¡œë”© ì¤‘..." onerror="this.src='https://via.placeholder.com/400x300?text=IMAGE+ERROR'">
        <div class="price-overlay">
            <div class="label" id="coin-label">BTC LIVE</div>
            <div id="img-price" class="big-price">$ ---,---</div>
        </div>
        <div id="ai-badge" class="ai-watermark">â— AI AUTO OFF</div>
        <div class="text-overlay">
            <div id="scene-title">SYSTEM READY</div>
            <div id="scene-desc">ì‹¤ì‹œê°„ ë§¤ë§¤ ë¡œê·¸ê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
        </div>
    </div>

    <div class="control-panel">
        <div class="input-row">
            <select id="coin-select" onchange="changeCoin()">
                <option value="BTC">BTC</option><option value="ETH">ETH</option><option value="SOL">SOL</option>
                <option value="XRP">XRP</option><option value="BNB">BNB</option><option value="DOGE">DOGE</option>
                <option value="ADA">ADA</option><option value="TRX">TRX</option><option value="DOT">DOT</option><option value="SHIB">SHIB</option>
            </select>
            <input type="number" id="buy-amount" placeholder="ë§¤ìˆ˜ ê¸ˆì•¡" value="1000">
        </div>

        <div class="action-row">
            <div class="chart-container"><canvas id="myChart"></canvas></div>
            <div class="btn-group">
                <button class="btn btn-buy" onclick="trade('BUY')">ìˆ˜ë™ ë§¤ìˆ˜</button>
                <button class="btn btn-sell" onclick="trade('SELL')">ìˆ˜ë™ ì²­ì‚°</button>
                <button id="auto-btn" class="btn btn-auto" onclick="toggleAuto()">ğŸ¤– AI ìë™ë§¤ë§¤ ì‹œì‘ [OFF]</button>
            </div>
        </div>
    </div>

    <div class="log-box" id="sys-log">
        <div style="color:var(--gold); font-weight:bold; padding-bottom:5px; border-bottom:1px solid #333;">
            > SYSTEM KERNEL CONNECTED...
        </div>
    </div>

<script>
    // --- ë³€ìˆ˜ ---
    let cash = 10000; 
    let coinAmount = 0; 
    let avgPrice = 0;   
    let currentPrice = 0; 
    let targetCoin = "BTC"; 
    let chartInstance;
    let isAuto = false;
    let logCounter = 0; // ë¡œê·¸ ê³¼ë¶€í•˜ ë°©ì§€ìš© ì¹´ìš´í„°

    // [ì´ë¯¸ì§€: 15ì¥]
    const imgLib = {
        sad: [
            "1771031914844.jpg", "1771031156164.jpg", "1771031143287.jpg",
            "1771031132125.jpg", "1771031126585.jpg", "1771031150411.jpg",
            "1771031113457.jpg"
        ],
        happy: [
            "1771031091711.jpg", "1771031161938.jpg", "1771031909245.jpg",
            "1771031119110.jpg", "1771031097560.jpg", "1771031920544.jpg",
            "1771031085897.jpg", "1771031103731.jpg"
        ]
    };

    function getRandomImg(type) {
        const arr = imgLib[type];
        return arr[Math.floor(Math.random() * arr.length)];
    }

    function initChart() {
        const ctx = document.getElementById('myChart').getContext('2d');
        chartInstance = new Chart(ctx, {
            type: 'doughnut',
            data: { labels: ['CASH', targetCoin], datasets: [{ data: [100, 0], backgroundColor: ['#222', '#ff9f1a'], borderWidth: 0 }] },
            options: { cutout: '75%', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });
    }

    // --- ë¦¬ì–¼íƒ€ì„ ë¡œê·¸ í•¨ìˆ˜ ---
    function writeLog(type, message) {
        const logBox = document.getElementById('sys-log');
        const time = new Date().toLocaleTimeString('ko-KR', {hour12:false, hour:'2-digit', minute:'2-digit', second:'2-digit'});
        let colorClass = "log-info";
        
        if (type === 'BUY') colorClass = "log-buy";
        if (type === 'SELL') colorClass = "log-sell";
        if (type === 'SYS') colorClass = "log-sys";

        const html = `<div class="log-line"><span class="log-time">[${time}]</span><span class="${colorClass}">${message}</span></div>`;
        logBox.innerHTML = html + logBox.innerHTML;
    }

    function changeCoin() {
        targetCoin = document.getElementById('coin-select').value;
        document.getElementById('coin-label').innerText = targetCoin + " LIVE";
        if (coinAmount > 0) {
            alert("ë³´ìœ  ì½”ì¸ ì²­ì‚° í›„ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
            document.getElementById('coin-select').value = "BTC";
            targetCoin = "BTC";
            return;
        }
        fetchPrice();
        writeLog("SYS", `íƒ€ê²Ÿ ë³€ê²½ ì™„ë£Œ: ${targetCoin} ì¶”ì  ì‹œì‘`);
    }

    function toggleAuto() {
        isAuto = !isAuto;
        const btn = document.getElementById('auto-btn');
        const badge = document.getElementById('ai-badge');
        
        if (isAuto) {
            btn.innerHTML = "ğŸ¤– AI ìë™ë§¤ë§¤ ì¤‘ [ON]";
            btn.classList.add('on');
            badge.innerHTML = "â— AI AUTO RUNNING";
            badge.classList.add('ai-active');
            writeLog("SYS", "AI ìë™ë§¤ë§¤ ì—”ì§„ ê°€ë™. íŒ¨í„´ ë¶„ì„ ì‹œì‘.");
        } else {
            btn.innerHTML = "ğŸ¤– AI ìë™ë§¤ë§¤ ì‹œì‘ [OFF]";
            btn.classList.remove('on');
            badge.innerHTML = "â— AI AUTO OFF";
            badge.classList.remove('ai-active');
            writeLog("SYS", "AI ìë™ë§¤ë§¤ ì¢…ë£Œ. ìˆ˜ë™ ëª¨ë“œ ì „í™˜.");
        }
    }

    function checkAutoTrade(roi) {
        if (!isAuto || currentPrice === 0) return;

        // ë¡œê·¸ ê³¼ë¶€í•˜ ë°©ì§€: 10ë²ˆì— 1ë²ˆë§Œ "ê°ì‹œ ì¤‘" ë¡œê·¸ ì¶œë ¥
        logCounter++;
        if (logCounter % 10 === 0) {
            if(coinAmount > 0) writeLog("INFO", `[ë³´ìœ ì¤‘] ìˆ˜ìµë¥  ${roi.toFixed(2)}% ê°ì‹œ ì¤‘...`);
            else writeLog("INFO", `[ëŒ€ê¸°ì¤‘] ${targetCoin} ì§„ì… íƒ€ì´ë° ìŠ¤ìº” ì¤‘...`);
        }

        if (coinAmount === 0) {
            if (Math.random() > 0.95) {
                const inputAmt = parseFloat(document.getElementById('buy-amount').value) || 1000;
                if (cash >= inputAmt) {
                    writeLog("SYS", "AI ë§¤ìˆ˜ ì‹œê·¸ë„ í¬ì°©! ì§„ì… ì‹œë„.");
                    trade('BUY', true);
                }
            }
        } else {
            if (roi >= 0.5) {
                writeLog("SYS", `ëª©í‘œ ìˆ˜ìµ ë‹¬ì„± (+${roi.toFixed(2)}%). ìµì ˆ ì‹¤í–‰.`);
                trade('SELL', true);
            } else if (roi <= -1.5) {
                writeLog("SYS", `ì†ì ˆ ë¼ì¸ ì´íƒˆ (-${roi.toFixed(2)}%). ë°©ì–´ ì‹¤í–‰.`);
                trade('SELL', true);
            }
        }
    }

    async function fetchPrice() {
        try {
            const res = await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${targetCoin}USDT`);
            const data = await res.json();
            currentPrice = parseFloat(data.price);
            
            let displayPrice = currentPrice < 1 ? currentPrice.toFixed(5) : Math.floor(currentPrice).toLocaleString();
            document.getElementById('img-price').innerText = `$ ${displayPrice}`;
            
            updateDashboard();
        } catch (e) {}
    }

    function trade(type, isAutoTrade = false) {
        if (currentPrice === 0) return alert("ì‹œì„¸ ë¡œë”© ì¤‘...");
        const inputAmount = parseFloat(document.getElementById('buy-amount').value);
        const prefix = isAutoTrade ? "[AI]" : "[ìˆ˜ë™]";

        if (type === 'BUY') {
            if (isNaN(inputAmount) || inputAmount <= 0) return alert("ê¸ˆì•¡ ì˜¤ë¥˜");
            if (cash < inputAmount) return !isAutoTrade && alert("ì”ì•¡ ë¶€ì¡±");

            let newCoins = inputAmount / currentPrice;
            let totalCost = (coinAmount * avgPrice) + inputAmount;
            coinAmount += newCoins;
            avgPrice = totalCost / coinAmount;
            cash -= inputAmount;

            writeLog("BUY", `${prefix} ë§¤ìˆ˜ì²´ê²° | $${currentPrice.toLocaleString()} | ${newCoins.toFixed(4)} ${targetCoin}`);
        
        } else if (type === 'SELL') {
            if (coinAmount <= 0) return !isAutoTrade && alert("ì½”ì¸ ì—†ìŒ");
            
            let sellVal = coinAmount * currentPrice;
            let profitRate = ((currentPrice - avgPrice) / avgPrice) * 100;
            let profitClass = profitRate >= 0 ? "+" : "";
            
            writeLog("SELL", `${prefix} ë§¤ë„ì²´ê²° | $${currentPrice.toLocaleString()} | ${profitClass}${profitRate.toFixed(2)}%`);
            writeLog("SYS", `ì •ì‚° ì™„ë£Œ | ì”ì•¡: $${Math.floor(cash + sellVal).toLocaleString()}`);
            
            cash += sellVal;
            coinAmount = 0; 
            avgPrice = 0;
        }
        updateDashboard();
    }

    function updateDashboard() {
        const evalCoin = coinAmount * currentPrice;
        const totalAsset = cash + evalCoin;
        const roi = coinAmount > 0 ? ((currentPrice - avgPrice) / avgPrice) * 100 : 0;

        document.getElementById('total-val').innerText = Math.floor(totalAsset).toLocaleString();
        document.getElementById('coin-val').innerText = Math.floor(evalCoin).toLocaleString();
        
        const pnlEl = document.getElementById('pnl-val');
        const roiEl = document.getElementById('roi-val');
        const profit = evalCoin - (coinAmount * avgPrice);
        
        pnlEl.innerText = profit > 0 ? `+${profit.toFixed(2)}` : profit.toFixed(2);
        roiEl.innerText = roi.toFixed(2) + "%";
        
        const colorClass = profit >= 0 ? "val up" : "val down";
        pnlEl.className = colorClass;
        roiEl.className = colorClass;

        if(chartInstance) {
            chartInstance.data.datasets[0].data = [cash, evalCoin];
            chartInstance.update();
        }

        updateNarrative(roi);
        checkAutoTrade(roi);
    }

    function updateNarrative(roi) {
        const img = document.getElementById('main-img');
        const title = document.getElementById('scene-title');
        const desc = document.getElementById('scene-desc');
        const box = document.getElementById('narrative-container');

        if (coinAmount === 0) {
            if (!img.src.includes("177")) img.src = getRandomImg('sad'); 
            title.innerText = "SEARCHING...";
            desc.innerText = `${targetCoin} ì§„ì… íƒ€ì´ë° ë¶„ì„ ì¤‘`;
            box.className = "narrative-box";
        } else if (roi >= 0.2) { 
            if (img.getAttribute('data-mode') !== 'happy' || Math.random() > 0.98) {
                img.src = getRandomImg('happy');
                img.setAttribute('data-mode', 'happy');
                writeLog("INFO", "ì„œì‚¬ ë³€ê²½: í–‰ë³µ ëª¨ë“œ (ìˆ˜ìµ êµ¬ê°„)");
            }
            title.innerText = "PROFIT ZONE";
            desc.innerText = "ìˆ˜ìµ ì‹¤í˜„ êµ¬ê°„. ê¸ì •ì  íë¦„.";
            box.className = "narrative-box reunion-glow";
        } else {
            if (img.getAttribute('data-mode') !== 'sad' || Math.random() > 0.98) {
                img.src = getRandomImg('sad');
                img.setAttribute('data-mode', 'sad');
                writeLog("INFO", "ì„œì‚¬ ë³€ê²½: ì¸ë‚´ ëª¨ë“œ (ì†ì‹¤ êµ¬ê°„)");
            }
            title.innerText = "HOLDING...";
            desc.innerText = "ì¡°ì • êµ¬ê°„. ë°˜ë“± ëŒ€ê¸° ì¤‘.";
            box.className = "narrative-box";
        }
    }

    initChart();
    setInterval(fetchPrice, 1500); 
</script>
</body>
</html>
